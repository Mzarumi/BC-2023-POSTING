#pragma warning disable AA0005, AA0008, AA0018, AA0021, AA0072, AA0137, AA0201, AA0206, AA0218, AA0228, AL0254, AL0424, AS0011, AW0006 // ForNAV settings
PageExtension 52186279 pageextension52186279 extends "Marketing Setup"
{
    layout
    {
        modify("Attachment Storage Type")
        {
            ApplicationArea = Basic;
        }
        modify("Attachment Storage Location")
        {
            ApplicationArea = Basic;
        }
        modify("Inherit Salesperson Code")
        {
            ApplicationArea = Basic;
        }
        modify("Inherit Territory Code")
        {
            ApplicationArea = Basic;
        }
        modify("Inherit Country/Region Code")
        {
            ApplicationArea = Basic;
        }
        modify("Inherit Language Code")
        {
            ApplicationArea = Basic;
        }
        modify("Inherit Address Details")
        {
            ApplicationArea = Basic;
        }
        modify("Inherit Communication Details")
        {
            ApplicationArea = Basic;
        }
        modify("Default Salesperson Code")
        {
            ApplicationArea = Basic;
        }
        modify("Default Territory Code")
        {
            ApplicationArea = Basic;
        }
        modify("Default Country/Region Code")
        {
            ApplicationArea = Basic;
        }
        modify("Default Language Code")
        {
            ApplicationArea = Basic;
        }
        modify("Default Correspondence Type")
        {
            ApplicationArea = Basic;
        }
        modify("Def. Company Salutation Code")
        {
            ApplicationArea = Basic;
        }
        modify("Default Person Salutation Code")
        {
            ApplicationArea = Basic;
        }
        modify("Default Sales Cycle Code")
        {
            ApplicationArea = Basic;
        }
        modify("Default To-do Date Calculation")
        {
            Caption = 'To-do Date Calculation';
            ApplicationArea = Basic;
        }
        modify("Mergefield Language ID")
        {
            ApplicationArea = Basic;
        }
        modify("Bus. Rel. Code for Customers")
        {
            ApplicationArea = Basic;
        }
        modify("Bus. Rel. Code for Vendors")
        {
            ApplicationArea = Basic;
        }
        modify("Bus. Rel. Code for Bank Accs.")
        {
            ApplicationArea = Basic;
        }
        modify("Contact Nos.")
        {
            ApplicationArea = Basic;
        }
        modify("Campaign Nos.")
        {
            ApplicationArea = Basic;
        }
        modify("Segment Nos.")
        {
            ApplicationArea = Basic;
        }
        modify("To-do Nos.")
        {
            ApplicationArea = Basic;
        }
        modify("Opportunity Nos.")
        {
            ApplicationArea = Basic;
        }
        modify("Maintain Dupl. Search Strings")
        {
            ApplicationArea = Basic;
        }
        modify("Autosearch for Duplicates")
        {
            ApplicationArea = Basic;
        }
        modify("Search Hit %")
        {
            ApplicationArea = Basic;
        }
        modify("Email Logging")
        {
            Caption = 'E-Mail Logging';

            //Unsupported feature: Property Modification (Name) on ""Email Logging"(Control 1900887301)".

        }
        modify("Autodiscovery E-Mail Address")
        {
            ApplicationArea = Basic;
        }
        modify("Exchange Service URL")
        {
            ApplicationArea = Basic;
        }
        modify("Exchange Account User Name")
        {
            ApplicationArea = Basic;
        }
        modify(ExchangeAccountPasswordTemp)
        {
            ApplicationArea = Basic;
        }
        // modify("Email Batch Size")
        // {
        //     ApplicationArea = Basic;
        // }
        modify("Queue Folder Path")
        {
            ApplicationArea = Basic;
        }
        modify("Storage Folder Path")
        {
            ApplicationArea = Basic;
        }

        //Unsupported feature: Property Deletion (Visible) on "General(Control 1)".


        //Unsupported feature: Property Deletion (GroupType) on "General(Control 1)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Attachment Storage Type"(Control 2)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Attachment Storage Location"(Control 4)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Inherit Salesperson Code"(Control 13)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Inherit Territory Code"(Control 14)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Inherit Country/Region Code"(Control 15)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Inherit Language Code"(Control 16)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Inherit Address Details"(Control 17)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Inherit Communication Details"(Control 79)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Default Salesperson Code"(Control 30)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Default Territory Code"(Control 28)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Default Country/Region Code"(Control 26)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Default Language Code"(Control 24)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Default Correspondence Type"(Control 102)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Def. Company Salutation Code"(Control 22)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Default Person Salutation Code"(Control 86)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Default Sales Cycle Code"(Control 20)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Default To-do Date Calculation"(Control 124)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Mergefield Language ID"(Control 55)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Bus. Rel. Code for Customers"(Control 56)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Bus. Rel. Code for Vendors"(Control 58)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Bus. Rel. Code for Bank Accs."(Control 60)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Contact Nos."(Control 62)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Campaign Nos."(Control 64)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Segment Nos."(Control 66)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""To-do Nos."(Control 68)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Opportunity Nos."(Control 70)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Maintain Dupl. Search Strings"(Control 75)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Autosearch for Duplicates"(Control 77)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Search Hit %"(Control 73)".


        //Unsupported feature: Property Deletion (GroupType) on ""Email Logging"(Control 1900887301)".


        //Unsupported feature: Code Modification on ""Autodiscovery E-Mail Address"(Control 3).OnValidate".

        //trigger OnValidate()
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
        /*
        IF "Autodiscovery E-Mail Address" <> xRec."Autodiscovery E-Mail Address" THEN BEGIN
          OnAfterMarketingSetupEmailLoggingUsed;
          ExchangeWebServicesClient.InvalidateService
        END;
        */
        //end;
        //>>>> MODIFIED CODE:
        //begin
        /*
        IF "Autodiscovery E-Mail Address" <> xRec."Autodiscovery E-Mail Address" THEN
          ExchangeWebServicesClient.InvalidateService;
        */
        //end;

        //Unsupported feature: Property Deletion (ToolTipML) on ""Autodiscovery E-Mail Address"(Control 3)".



        //Unsupported feature: Code Modification on ""Exchange Service URL"(Control 12).OnValidate".

        //trigger OnValidate()
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
        /*
        IF "Exchange Service URL" <> xRec."Exchange Service URL" THEN BEGIN
          OnAfterMarketingSetupEmailLoggingUsed;
          ExchangeWebServicesClient.InvalidateService
        END;
        */
        //end;
        //>>>> MODIFIED CODE:
        //begin
        /*
        IF "Exchange Service URL" <> xRec."Exchange Service URL" THEN
          ExchangeWebServicesClient.InvalidateService;
        */
        //end;

        //Unsupported feature: Property Deletion (ToolTipML) on ""Exchange Service URL"(Control 12)".



        //Unsupported feature: Code Modification on ""Exchange Account User Name"(Control 11).OnValidate".

        //trigger OnValidate()
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
        /*
        IF "Exchange Account User Name" <> xRec."Exchange Account User Name" THEN BEGIN
          OnAfterMarketingSetupEmailLoggingUsed;
          ExchangeWebServicesClient.InvalidateService;
        END;
        */
        //end;
        //>>>> MODIFIED CODE:
        //begin
        /*
        IF "Exchange Account User Name" <> xRec."Exchange Account User Name" THEN
          ExchangeWebServicesClient.InvalidateService;
        */
        //end;

        //Unsupported feature: Property Deletion (ToolTipML) on ""Exchange Account User Name"(Control 11)".



        //Unsupported feature: Code Modification on "ExchangeAccountPasswordTemp(Control 18).OnValidate".

        //trigger OnValidate()
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
        /*
        OnAfterMarketingSetupEmailLoggingUsed;
        SetExchangeAccountPassword(ExchangeAccountPasswordTemp);
        COMMIT;
        ExchangeWebServicesClient.InvalidateService;
        */
        //end;
        //>>>> MODIFIED CODE:
        //begin
        /*
        #2..4
        */
        //end;

        //Unsupported feature: Property Deletion (ToolTipML) on "ExchangeAccountPasswordTemp(Control 18)".

        modify("Email Batch Size")
        {
            Visible = false;
        }

        //Unsupported feature: Property Deletion (ToolTipML) on ""Email Batch Size"(Control 8)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Queue Folder Path"(Control 104)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Storage Folder Path"(Control 19)".


        //Unsupported feature: Property Deletion (ApplicationArea) on "Control1900383207(Control 1900383207)".


        //Unsupported feature: Property Deletion (ApplicationArea) on "Control1905767507(Control 1905767507)".

        addafter(Interactions)
        {
            group(Synchronization)
            {
                Caption = 'Synchronization';
                field(EnableSynchronization; GlobalSynchronizationIsEnabled)
                {
                    ApplicationArea = Basic;
                    Caption = 'Enable Synchronization';

                    trigger OnValidate()
                    begin
                        if GlobalSynchronizationIsEnabled = IntegrationManagement.IsIntegrationServicesEnabled then
                            exit;

                        if GlobalSynchronizationIsEnabled then begin
                            if not Confirm(EnableIntegrationServicesQst) then
                                Error('');
                            IntegrationManagement.EnableIntegrationServices
                        end else begin
                            if not Confirm(DisableIntegrationServicesQst) then
                                Error('');
                            IntegrationManagement.DisableIntegrationServices;
                            //   IntegrationManagement.DisableConnector;
                            //   "Enable Connector" := false;
                        end;
                    end;
                }
            }
        }
        addafter("Bus. Rel. Code for Bank Accs.")
        {
            // field("Enable Connector";"Enable Connector")
            // {
            //     ApplicationArea = Basic;
            //     Enabled = GlobalSynchronizationIsEnabled;
            // }
        }
    }
    actions
    {
        // modify("Social Engagement Setup")
        // {
        //     ApplicationArea = Basic;
        // }
        modify("Duplicate Search String Setup")
        {
            ApplicationArea = Basic;
        }
        modify("Validate EmailLogging Setup")
        {
            ApplicationArea = Basic;
        }
        modify("Clear EmailLogging Setup")
        {
            ApplicationArea = Basic;
        }
        modify("Generate Integration IDs for Connector for Microsoft Dynamics")
        {
            ApplicationArea = Basic;
        }

        //Unsupported feature: Property Deletion (ToolTipML) on ""Social Engagement Setup"(Action 10)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Duplicate Search String Setup"(Action 101)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Validate EmailLogging Setup"(Action 7)".


        //Unsupported feature: Property Deletion (ToolTipML) on ""Clear EmailLogging Setup"(Action 51)".



        //Unsupported feature: Code Modification on ""Generate Integration IDs for Connector for Microsoft Dynamics"(Action 52).OnAction".

        //trigger OnAction()
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
        /*
        IF CONFIRM(Text004,TRUE) THEN BEGIN
          IntegrationManagement.SetupIntegrationTables;
          MESSAGE(Text005);
        END;
        */
        //end;
        //>>>> MODIFIED CODE:
        //begin
        /*
        TESTFIELD("Enable Connector");
        #1..4
        */
        //end;

        //Unsupported feature: Property Deletion (ToolTipML) on ""Generate Integration IDs for Connector for Microsoft Dynamics"(Action 52)".

    }

    var
        IntegrationManagement: Codeunit "Integration Management";

    var
        GlobalSynchronizationIsEnabled: Boolean;
        DisableIntegrationServicesQst: label 'Disabling integration services will disable the feature for all companies and tenants. The operation requires SUPER user permissions. Do you want to continue?';
        EnableIntegrationServicesQst: label 'Enabling integration services will enable all companies and tenants to enable the connector. The operation requires SUPER user permissions. Do you want to continue?';


    //Unsupported feature: Code Insertion on "OnAfterGetRecord".

    //trigger OnAfterGetRecord()
    //begin
    /*
    IF "Enable Connector" AND NOT GlobalSynchronizationIsEnabled THEN BEGIN
      IntegrationManagement.DisableConnector;
      "Enable Connector" := FALSE;
    END;
    */
    //end;


    //Unsupported feature: Code Modification on "OnOpenPage".

    //trigger OnOpenPage()
    //>>>> ORIGINAL CODE:
    //begin
    /*
    RESET;
    IF NOT GET THEN BEGIN
      INIT;
      INSERT;
    END;

    AttachmentStorageLocationEnabl := "Attachment Storage Type" = "Attachment Storage Type"::"Disk File";
    ExchangeAccountPasswordTemp := '';
    IF ("Exchange Account User Name" <> '') AND (NOT ISNULLGUID("Exchange Account Password Key")) THEN
      ExchangeAccountPasswordTemp := '**********';
    */
    //end;
    //>>>> MODIFIED CODE:
    //begin
    /*
    #1..7
    GlobalSynchronizationIsEnabled := IntegrationManagement.IsIntegrationServicesEnabled;
    #8..10
    */
    //end;

    //Unsupported feature: Property Deletion (Attributes) on "SetAttachmentStorageType(PROCEDURE 1)".


    //Unsupported feature: Property Deletion (Attributes) on "SetAttachmentStorageLocation(PROCEDURE 3)".


    //Unsupported feature: Property Deletion (Attributes) on "InitExchangeService(PROCEDURE 2)".



    //Unsupported feature: Code Modification on "InitExchangeService(PROCEDURE 2)".

    //procedure InitExchangeService();
    //Parameters and return type have not been exported.
    //>>>> ORIGINAL CODE:
    //begin
    /*
    IF "Autodiscovery E-Mail Address" = '' THEN
      ERROR(Text006);

    IF "Exchange Account User Name" <> '' THEN BEGIN
      CreateExchangeAccountCredentials(Credentials);
      Result :=
        ExchangeWebServicesClient.InitializeOnServer("Autodiscovery E-Mail Address",
          "Exchange Service URL",Credentials.Credentials());
    END ELSE
      Result := ExchangeWebServicesClient.InitializeOnClient("Autodiscovery E-Mail Address","Exchange Service URL");

    IF NOT Result THEN
      ERROR(Text007);
    */
    //end;
    //>>>> MODIFIED CODE:
    //begin
    /*
    #1..6
        ExchangeWebServicesClient.InitializeOnServer("Autodiscovery E-Mail Address","Exchange Service URL",Credentials);
    #9..13
    */
    //end;

    //Unsupported feature: Property Deletion (Attributes) on "ClearEmailLoggingSetup(PROCEDURE 5)".


    //Unsupported feature: Variable Insertion (Variable: EMailLoggingDispatcher) (VariableCollection) on "ValidateEmailLoggingSetup(PROCEDURE 6)".



    //Unsupported feature: Code Modification on "ValidateEmailLoggingSetup(PROCEDURE 6)".

    //procedure ValidateEmailLoggingSetup();
    //Parameters and return type have not been exported.
    //>>>> ORIGINAL CODE:
    //begin
    /*
    ExchangeWebServicesClient.InvalidateService;

    ValidationCaption := FIELDCAPTION("Autodiscovery E-Mail Address");
    ProgressWindow.OPEN(Text013,ValidationCaption);

    IF "Exchange Account User Name" <> '' THEN BEGIN
      CreateExchangeAccountCredentials(Credentials);
      CanInitialize := ExchangeWebServicesClient.InitializeOnServer("Autodiscovery E-Mail Address",
          "Exchange Service URL",Credentials.Credentials());
    END ELSE
      CanInitialize := ExchangeWebServicesClient.InitializeOnClient("Autodiscovery E-Mail Address","Exchange Service URL");

    #13..28
      EXIT(FALSE);
    END;

    // Emails cannot be automatically logged unless Interaction Template Setup configured correctly.
    ValidationCaption := Text016;
    ProgressWindow.UPDATE;
    IF NOT EmailLoggingDispatcher.CheckInteractionTemplateSetup(ErrorMsg) THEN
      EXIT(FALSE);

    ProgressWindow.CLOSE;
    CLEAR(ErrorMsg);
    MarketingSetup.MODIFY;

    OnAfterMarketingSetupEmailLoggingCompleted;
    EXIT(TRUE);
    */
    //end;
    //>>>> MODIFIED CODE:
    //begin
    /*
    #1..8
          "Exchange Service URL",Credentials);
    #10..31
    // E-Mails cannot be automatically logged unless Interaction Template Setup configured correctly.
    ValidationCaption := Text016;
    ProgressWindow.UPDATE;
    IF NOT EMailLoggingDispatcher.CheckInteractionTemplateSetup(ErrorMsg) THEN
    #36..41
    EXIT(TRUE);
    */
    //end;

    //Unsupported feature: Property Modification (ExternalDataType) on "InitExchangeService(PROCEDURE 2).Credentials(Variable 1001)".


    //Unsupported feature: Deletion (VariableCollection) on "ValidateEmailLoggingSetup(PROCEDURE 6).EmailLoggingDispatcher(Variable 1005)".


    //Unsupported feature: Property Modification (ExternalDataType) on "ValidateEmailLoggingSetup(PROCEDURE 6).Credentials(Variable 1006)".


    //Unsupported feature: Property Deletion (ApplicationArea).


    //Unsupported feature: Property Deletion (UsageCategory).

}
